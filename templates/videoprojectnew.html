<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="icon" type="image/jpg" href="/static/images/icon-2.png" />
    <link rel="stylesheet" href="../static/style.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">

    <title>Video</title>
    <style>
        body {
            color: white;
            margin: 0;
            padding: 0;
            font-family: 'Arial', sans-serif;
        }

        header.feature-box.top {
            background-color: #375a7e;
            height: 100px;
            margin: 0;
            padding: 20px;
            text-align: center;
        }

        header.feature-box.second {
            background-color: #000000;
            height: 50px;
            text-align: center;
            margin-top: -25px;
        }

        .btnCustom {
            background-color: #67a5e3;
            color: #000000;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }

        .custom-file-input {
            display: none;
        }

        .col-sm {
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #000000;
            border-radius: 35px;
            margin: 40px auto;
            padding: 20px;
            width: 60%; /* Adjust the width as needed */
            max-width: 800px; /* Adjust the max-width as needed */
        }

        .video-upload-icon {
            position: relative;
            width: 100%;
            height: 0; /* This will be determined by the aspect ratio */
            padding-bottom: 56.25%; /* Aspect ratio */
        }

        video#uploadedVideo {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 35px;
        }

        .upload-icon {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3em;
            color: #ffffff;
            pointer-events: none;
        }

        .upload-icon::before {
            content: '\f093';
            font-family: 'Font Awesome 5 Free',serif;
            font-weight: 900;
        }

        .file-label {
            cursor: pointer;
            padding: 8px 12px;
            background-color: #3e5267;
            color: #fff;
            border: none;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        .file-label:hover {
            background-color: #283442;
        }

    </style>
</head>
<body>

<header class="feature-box top">
    <h1><strong>Accident Detection via Video Upload</strong></h1>
</header>

<section class="col-sm">
    <div class="video-upload-icon">
        <i class="fas fa-upload upload-icon" id="upload-icon"></i>
        <video id="uploadedVideo" controls loop playsinline style="display: none;">
                <source id="videoSource" type="video/mp4" src="{{ url_for('video') }}">
        </video>
    </div>
</section>

<!--<section class="col-sm" >-->
<!--          <img src="{{ url_for('video') }}"   alt="Upload video">-->
<!--</section>-->


<section>
        <div class="new" style="text-align: center; display: flex; flex-direction: column; align-items: center;">
            <form method='POST' enctype="multipart/form-data">
                {{ form.hidden_tag() }}
                <label for="fileInput" class="file-label">
                    Choose File
                </label>
                {{ form.file(id="fileInput", class_="custom-file-input") }}
                <button type="submit" name="favorite" value="x" class="btnCustom">
                    Submit
                </button>

            </form>
        </div>
</section>

<script>
    // Assign the server-side generated URL to a JavaScript variable
    const videoUrl = "{{ url_for('video') }}";

    document.getElementById('video-upload-form').addEventListener('submit', function(event) {
        event.preventDefault();
        const formData = new FormData(this);

        // Hide the upload icon
        document.getElementById('upload-icon').style.display = 'none';

        // Show the video player
        const videoPlayer = document.getElementById('uploadedVideo');
        videoPlayer.style.display = 'block';

        // Set the video source to the URL generated by the server
        document.getElementById('videoSource').src = videoUrl;

        // Load the new video source and play it
        videoPlayer.load();
        videoPlayer.play();
    });
</script>

</body>
</html>
